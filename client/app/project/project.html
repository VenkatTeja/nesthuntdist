<div class="fullW thumbs_wrap paddingLR bglg">
	<div id="hidden"></div>
	<h3 class="colorbl centric">Projects of {{projectCtrl.user().name}}</h3>
<section class="thumbs_wrap" ng-class="{ 'col-md-4' : projectCtrl.myProjects.length, 'col-md-2' : !projectCtrl.myProjects.length}">
	<div class="padding10 fullW colorlb bgw borderLt box_shadow_dwn centric" style="margin-bottom:10px" ng-click="projectCtrl.$state.reload()">+Add Project</div>
	<div class="fullW bgw box_shadow_dwn borderLt" ng-repeat="project in projectCtrl.myProjects" style="margin-bottom:10px" ng-click="projectCtrl.editThis(project)">
		<img src="{{project.imagesInt[0]}}" width="100%"/>
		<div class="fullW padding10">
			<p class="size20"><b>{{project.name}}</b></p>
			<p ng-repeat="category in project.type.categories">size:{{category.size}}; cost:{{category.totalPrice}}</p>
		</div>
	</div>
</section>
<section class="thumbs_wrap col-md-8">

	<section class="fullW thumbs_wrap bgw borderLt">
		<div ng-repeat="step in projectCtrl.steps" class="thumbs_wrap valignOut col-xs-{{12/projectCtrl.steps.length}}" style="padding:20px 10px" ng-class="{colorblue: projectCtrl.uploadStep==($index+1)}">
				{{step.name}} ({{$index+1}}/{{projectCtrl.steps.length}})
		</div >
	</section>
	<section class="fullW thumbs_wrap bgw borderLt padding10" ng-repeat="step in projectCtrl.steps" ng-show="projectCtrl.uploadStep==step.number">
		<form name="projectForm">
			<div ng-include="'step'+step.number+'.html'"></div>
			<md-button class="md-primary" ng-hide="step.number==1" ng-click="projectCtrl.nextStep(-1)">Back</md-button>
			<md-button class="md-primary floatR" ng-disabled="formStep{{step.number}}.$invalid" ng-hide="step.number==projectCtrl.steps.length" ng-click="projectCtrl.nextStep(1)">Next ({{step.number}}/{{projectCtrl.steps.length}})</md-button>
			<button type="button" class="b2w floatR" ng-click="projectCtrl.savePost(projectCtrl.project)" ng-show="projectCtrl.project._id" style="padding: 10px" ng-disabled="formStep{{$index+1}}.$invalid">Save Edits</button>
		</form>
	</section>
	
</section>
</div>

<script type="text/ng-template" id="step2.html">
	<div layout="row">
		<md-input-container flex="100">
			<label>Project Name</label>
			<input autofocus required name="name" ng-model="projectCtrl.project.name">
			<div ng-messages="projectForm.name.$error">
				<div ng-message="required">This is required.</div>
			</div>
		</md-input-container>
	</div>

	<md-input-container class="md-block fullW thumbs_wrap">
		<label>Description</label>
		<input md-maxlength="100" required md-no-asterisk name="description" ng-model="projectCtrl.project.info">
		<div ng-messages="projectForm.description.$error">
			<div ng-message="required">This is required.</div>
			<div ng-message="md-maxlength">The description must be less than 100 characters long.</div>
		</div>
	</md-input-container>
	<div class="fullW thumbs_wrap">
		<label class="floatL fullW thumbs_wrap">Project Status</label>
		<md-radio-group ng-model="projectCtrl.project.status">
	      	<md-radio-button value="1" class="md-primary col-sm-4">Ongoing</md-radio-button>
	      	<md-radio-button value="2" class="col-sm-4"> Upcoming </md-radio-button>
	      	<md-radio-button value="0" class="col-sm-4">Completed</md-radio-button>
	    </md-radio-group>
	</div>

	<md-input-container>
		<label>Project email Id</label>
		<input required name="mailId" ng-model="projectCtrl.project.mailId">
		<div ng-messages="projectForm.mailId.$error">
			<div ng-message="required">This is required.</div>
		</div>
	</md-input-container>
</script>
<script type="text/ng-template" id="step3.html">
<div class="fullW thumbs_wrap">
	<label class="floatL fullW thumbs_wrap">Choose one</label>
	<md-radio-group ng-model="projectCtrl.project.type.type">
      	<md-radio-button value="1" class="md-primary col-sm-4">Land</md-radio-button>
      	<md-radio-button value="2" class="col-sm-4"> Flat </md-radio-button>
      	<md-radio-button value="3" class="col-sm-4">Villa</md-radio-button>
    </md-radio-group>
</div>
<hr/>
<p> Here you can add different types of categories of this project</p>
<div layout="row" class="fullW floatL" ng-repeat="category in projectCtrl.project.type.categories">
	<md-input-container flex="30">
		<label>Size</label>
		<input required type="number" name="devCharges" ng-model="projectCtrl.project.type.categories[$index].size">
		<div ng-messages="projectForm.devCharges.$error">
			<div ng-message="required">This is required.</div>
		</div>
	</md-input-container>
	<md-input-container flex="30">
		<label>Number of units of this Size</label>
		<input required type="number" name="base" ng-model="projectCtrl.project.type.categories[$index].num">
		<div ng-messages="projectForm.base.$error">
			<div ng-message="required">This is required.</div>
		</div>
	</md-input-container>
	<md-input-container flex="30" ng-if="projectCtrl.project.type.type==3" style="margin-top:10px">
		<label>Villa Type</label>
		<md-select name="type" ng-model="projectCtrl.project.type.categories[$index].villaType" required md-no-asterisk="false">
			<md-option value="1">Land + Building</md-option>
			<md-option value="2">Building + UDS</md-option>
		</md-select>
	</md-input-container>
	<div flex="5" ng-click="projectCtrl.project.type.categories.splice($index, 1)" class="valignOut" ng-if="$index">&#x2715;</div>
	<div flex="5" ng-hide="false" ng-bind="projectCtrl.project.type.categories[$index].totalPrice=projectCtrl.project.type.rps.total*projectCtrl.project.type.categories[$index].size"></div>
</div>	
<md-button style="margin:0px 0px 10px" ng-click="projectCtrl.project.type.categories.push({num:0,size:0})" class="md-raised md-primary">Add More</md-button>

<!--<md-input-container>
	<label>Number of <span ng-if="projectCtrl.project.type==1">Plots</span><span ng-if="projectCtrl.project.type==2">Towers</span><span ng-if="projectCtrl.project.type==3">Villas</span></label>
	<input type="number" required name="num" ng-model="projectCtrl.project.type.num" ng-change="projectCtrl.setSize(projectCtrl.project.type.num)">
	<div ng-messages="projectForm.num.$error">
		<div ng-message="required">This is required.</div>
	</div>
</md-input-container>


<div class="fullW thumbs_wrap" ng-show="projectCtrl.project.type.size.length">
	<div class="fullW floatL"><label>Size of Each</label></div>
	<md-input-container ng-repeat="size in projectCtrl.project.type.size track by $index" class="col-xs-2 floatL">
		<input required name="size{{$index}}" ng-model="projectCtrl.project.type.size[$index]" placeholder="Size {{$index+1}}">
		<div ng-messages="projectForm.size{{$index}}.$error">
			<div ng-message="required">Required.</div>
		</div>
	</md-input-container>
</div>-->

<div class="fullW thumbs_wrap">
	<md-input-container class="md-block" flex-gt-sm ng-if="projectCtrl.project.type.type==1">
        <label>Layout Number</label>
        <input name="layoutNo" ng-model="projectCtrl.project.type.layoutNo" required>

        <div ng-messages="projectForm.layoutNo.$error" role="alert" multiple>
          <div ng-message="required" class="my-message">Layout number is compulsory</div>
        </div>
		</md-input-container>
	<div class="fullW" ng-if="projectCtrl.project.type.type==2">
		<!--<div class="fullW floatL"><label>No. of flats in each tower</label></div>
		<md-input-container ng-repeat="size in projectCtrl.project.type.size track by $index" class="col-xs-2 floatL">
			<input required name="upt{{$index}}" ng-model="projectCtrl.project.type.upt[$index]" placeholder="Tower {{$index+1}}">
			<div ng-messages="projectForm.upt{{$index}}.$error">
				<div ng-message="required">Required.</div>
			</div>
		</md-input-container>-->

		<md-input-container class="fullW floatL">
			<label>Percent UDS</label>
			<input required name="percentUDS" ng-model="projectCtrl.project.type.percentUDS">
			<div ng-messages="projectForm.percentUDS.$error">
				<div ng-message="required">This is required.</div>
			</div>
		</md-input-container>
	</div>
</div>
<br/>
<div class="fullW floatL"><label>Rate/Sq.Feet</label></div>
<div layout="row" class="fullW floatL">
	<div ng-hide="true" ng-bind="projectCtrl.project.type.rps.total=projectCtrl.project.type.rps.base+projectCtrl.project.type.rps.devCharges+projectCtrl.project.type.rps.others"></div>
	<md-input-container flex="34">
		<label>Base Price</label>
		<input required type="number" name="base" ng-model="projectCtrl.project.type.rps.base">
		<div ng-messages="projectForm.base.$error">
			<div ng-message="required">This is required.</div>
		</div>
	</md-input-container>
	<md-input-container flex="33">
		<label>Development Charges</label>
		<input required type="number" name="devCharges" ng-model="projectCtrl.project.type.rps.devCharges">
		<div ng-messages="projectForm.devCharges.$error">
			<div ng-message="required">This is required.</div>
		</div>
	</md-input-container>
	<md-input-container flex="33">
		<label>Other Charges</label>
		<input required type="number" name="others" ng-model="projectCtrl.project.type.rps.others">
		<div ng-messages="projectForm.others.$error">
			<div ng-message="required">This is required.</div>
		</div>
	</md-input-container>
</div>	
</script>

<!--Map-->
<script type="text/ng-template" id="step1.html">
	<div class="fullW thumbs_wrap">
		<label>Search places here</label>
        <input autofocus places-auto-complete placeholder="Search..." class="borderLt" ng-model="projectCtrl.project.location.name" component-restrictions="{country:'in'}"types="{{projectCtrl.types}}" on-place-changed="projectCtrl.placeChanged()" style="padding:5px;width:100%;font-size:20px" />
    </div>
	<div map-lazy-load="https://maps.google.com/maps/api/js"
    map-lazy-load-params="{{projectCtrl.googleMapsUrl}}" class="fullW thumbs_wrap">
      	<ng-map center='current-position' geo-fallback-center="[40.74, -74.18]" style="height:60vh" geo-callback="projectCtrl.getCenter(projectCtrl)">
       		<marker position="{{projectCtrl.coordinates}}" animation="Animation.BOUNCE" centered="true" draggable="true" on-dragend="projectCtrl.getCurrentLocation(projectCtrl)"></marker>
     	</ng-map>
    </div>
    <p class="padding10 centric fullW floatL colorg">
    	<b>Selected Address: {{projectCtrl.project.location.name}}</b>
    	<br/>
    	{{projectCtrl.project.location.lat | number:5}}, {{projectCtrl.project.location.lng | number:5}}
    </p>

    
</script>
<script type="text/ng-template" id="step4.html">

	<div layout="row" layout-wrap flex class="fullW thumbs_wrap">
    	<div class="demo-select-all-checkboxes" flex="100">
      		
			<md-input-container flex="50">
				<label>Legal Cleared by</label>
				<md-select name="legalBy" ng-model="projectCtrl.project.legalBy" required md-no-asterisk="false">
					<md-option value="1">Land + Building</md-option>
					<md-option value="2">Building + UDS</md-option>
				</md-select>
			</md-input-container>
      		<md-input-container flex="50">
				<label>Technical Cleared by</label>
				<md-select name="techBy" ng-model="projectCtrl.project.techBy" required md-no-asterisk="false">
					<md-option value="1">Land + Building</md-option>
					<md-option value="2">Building + UDS</md-option>
				</md-select>
			</md-input-container>
      		<md-checkbox ng-model="projectCtrl.project.approvals.dtcp">
       		DTCP
      		</md-checkbox>
      		<md-checkbox ng-model="projectCtrl.project.approvals.cmda">
       		CMDA
      		</md-checkbox>
      		<md-checkbox ng-model="projectCtrl.project.approvals.lpa">
       		LPA
      		</md-checkbox>
      		<md-checkbox ng-model="projectCtrl.project.approvals.panchayath">
       		Panchayath
      		</md-checkbox>
    	</div>
  	</div>
	<div>
		<md-button type="button" ng-click="projectCtrl.manageProject(projectCtrl.project)" ng-if="!projectCtrl.project._id">Submit</md-button>
	</div>
</script>

<script type="text/ng-template" id="step5.html">
	<div class="bgw thumbs_wrap fullW padding10" style="margin: 10px 0px" >
		<h4>Images of Project</h4>
		<upload-file heading="1) Image from Internal view" key="imagesInt/{{projectCtrl.project._id}}_1.jpg"></upload-file>
		<upload-file heading="2) Image from Internal view" key="imagesInt/{{projectCtrl.project._id}}_2.jpg"></upload-file>
		<upload-file heading="1) Image from External view" key="imagesExt/{{projectCtrl.project._id}}_1.jpg"></upload-file>
		<upload-file heading="2) Image from External view" key="imagesExt/{{projectCtrl.project._id}}_2.jpg"></upload-file>

		<upload-file heading="Image of Offer" key="offer/{{projectCtrl.project._id}}.jpg"></upload-file>
		<md-input-container flex="100">
			<label>Offers Text</label>
			<input required name="offerText" ng-model="projectCtrl.project.offers.text">
			<div ng-messages="projectForm.offerText.$error">
				<div ng-message="required">This is required.</div>
			</div>
		</md-input-container>
	</div>	
</script>